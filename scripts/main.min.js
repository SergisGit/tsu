!function(){"use strict";(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))&&document.querySelector("html").classList.add("is-ios");var e=window.matchMedia("(min-width: 768px)").matches?2:1,t=window.matchMedia("(min-width: 768px)").matches?[22.04622630078105,39.94769520495493]:[49.256614484375056,44.755914715920284];mapboxgl.accessToken="pk.eyJ1IjoiaXNzZXJnIiwiYSI6ImNqbWJ1MG4xZzA3YXUzd21pOTNieDZwdWMifQ.M_XBqcEKA-BFF-AG9ZW_5Q";var a=document.querySelector("#js-map");if(a){var i=a.getAttribute("data-graduates"),g=new mapboxgl.Map({container:a,style:"mapbox://styles/isserg/cjomx48pj92fk2st9b0712bk1",center:t,zoom:e,minZoom:e,maxZoom:e,scrollZoom:!1,dragRotate:!1,touchZoomRotate:!1});$.getJSON(i,function(e){g.on("load",function(){g.addSource("graduates",{type:"geojson",data:e});var p,l=new mapboxgl.Popup({closeButton:!0,closeOnClick:!0,className:"map__popup",offset:25});l.on("close",function(){p&&p.classList.remove("map__marker--active")});var m="data:image/svg+xml;utf8,<svg version='1.0' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g fill='%230047FF'><polygon points='12,3 1,9 12,15 23,9 '/><polygon points='19,12.8 12,17 5,12.8 5,17.2 12,21 19,17.2 '/><rect height='8' width='2' x='21' y='9'/></g></svg>";e.features.forEach(function(d,e){var t=d.properties.icon?d.properties.icon:m,a=document.createElement("div");a.id="marker-"+e,a.className="map__marker",a.innerHTML='<img src="'+t+'" alt="graduate" class="map__marker-icon">',new mapboxgl.Marker(a,{offset:[0,0]}).setLngLat(d.geometry.coordinates).addTo(g),a.addEventListener("click",function(e){e.stopPropagation(),p&&p.classList.remove("map__marker--active"),(p=this).classList.add("map__marker--active");var t=d.properties.name?d.properties.name:"Неизвестный",a=d.properties.image?d.properties.image:m,i=d.properties.year?'<div class="infowindow__year">’'+d.properties.year+"</div>":"",o=d.properties.place?'<div class="infowindow__place">'+d.properties.place+"</div>":"",r=d.properties.link?'<a href="'+d.properties.link+'" class="infowindow__btn  btn">ЧИТАТЬ ИСТОРИЮ</a>':"";l.setHTML('<div class="infowindow"><div class="infowindow__image-wrapper"><img class="infowindow__image" src="'+a+'" alt="'+t+'">'+i+'</div><div class="infowindow__content"><div class="infowindow__name">'+t+"</div>"+o+r+"</div></div>"),l.setLngLat({lng:d.geometry.coordinates[0],lat:d.geometry.coordinates[1]}).addTo(g);var s=l._container;s.style.width="",s.style.height="";var n=Math.round(s.offsetWidth);n%2!=0&&(s.style.width=n+1+"px");var c=Math.round(s.offsetHeight);c%2!=0&&(s.style.height=c+1+"px")})})})})}var o=$(".sharer");$.each(o,function(){var e=$(this);e.attr("data-url")||e.attr("data-url",window.location.href),e.attr("data-title")||e.attr("data-title",$(document).find("title").text())});var r=$("html, body");$("#js-upBtn").on("click",function(){return r.animate({scrollTop:0},500),!1})}();